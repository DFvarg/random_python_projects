IMPORTANT NOTE: I haven't yet checked to make sure the variables are all calculated correctly, this is just a demo
